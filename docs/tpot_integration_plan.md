```markdown
# TPOT Integration Plan ‚Äî Training Jobs Upgrade

**–°—Ç–∞—Ç—É—Å**: üü° –ü–ª–∞–Ω —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üéØ –ö–†–ò–¢–ò–ß–ù–û –î–õ–Ø Q1 2026
**–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞**: –ù–æ—è–±—Ä—å 27, 2025
**ETA**: 2 —Å–ø—Ä–∏–Ω—Ç–∞ —Å –±—É—Ñ–µ—Ä–∞–º–∏

---

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä –∏ —Ü–µ–ª–∏](#–æ–±–∑–æ—Ä-–∏-—Ü–µ–ª–∏)
2. [–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ](#—Ç–µ–∫—É—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ)
3. [–¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#—Ü–µ–ª–µ–≤–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
4. [–î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è](#–¥–æ—Ä–æ–∂–Ω–∞—è-–∫–∞—Ä—Ç–∞-–≤–Ω–µ–¥—Ä–µ–Ω–∏—è)
5. [–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Ä–µ–∂–∏–º—ã](#–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ-—Ä–µ–∂–∏–º—ã)
6. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–∏-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
7. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ QA](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-qa)
8. [–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è](#–Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å-–∏-—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è)
9. [–†–∏—Å–∫–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏](#—Ä–∏—Å–∫–∏-–∏-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
10. [–ü–ª–∞–Ω —Ä–∞—Å–∫–∞—Ç–∫–∏](#–ø–ª–∞–Ω-—Ä–∞—Å–∫–∞—Ç–∫–∏)
11. [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ–±—É—á–µ–Ω–∏–µ](#–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è-–∏-–æ–±—É—á–µ–Ω–∏–µ)

---

## üéØ –û–±–∑–æ—Ä –∏ —Ü–µ–ª–∏

### –ß—Ç–æ –º–µ–Ω—è–µ–º
- –ü–µ—Ä–µ–≤–æ–¥–∏–º TrainingService —Å —Ä—É—á–Ω—ã—Ö `LinearRegression`/`LogisticRegression` –Ω–∞ TPOT, –∏—Å–ø–æ–ª—å–∑—É—è —ç–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ pipeline-—Å—Ç—Ä—É–∫—Ç—É—Ä –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ `ConfigSpace`/`dict` (GraphSearchPipeline, ChoicePipeline, FSSNode, EstimatorNode).
- –î–æ–±–∞–≤–ª—è–µ–º –±–æ–≥–∞—Ç—ã–π leaderboard, Pareto front –∏ KPI (`best_pipeline`, `tp_generations`, `tp_population_size`).
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º —Ñ–ª–∞–≥–∏ `ENABLE_AUTOML`, `TPOT_PARALLEL_MODE` —Å `local`/`distributed` —Ä–µ–∂–∏–º–∞–º–∏, —Å–æ—Ö—Ä–∞–Ω—è—è fallback –Ω–∞ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—É—é –ª–æ–≥–∏–∫—É –æ–±—É—á–µ–Ω–∏—è.

### –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –º–æ–¥–µ–ª–µ–π –∑–∞–º–µ–Ω—è–µ—Ç —Ä—É—á–Ω—ã–µ –ø–æ–¥–±–æ—Ä—ã –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
- –°—Ç–∞–±–∏–ª—å–Ω—ã–π rollout —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º —Ä–µ—Å—É—Ä—Å–Ω—ã–º –±—é–¥–∂–µ—Ç–æ–º.
- –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ TPOT (Pareto front, leaderboard) –¥–æ—Å—Ç—É–ø–Ω—ã –≤ UI/Swagger.

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏
- TPOT –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, fallback –æ—Å—Ç–∞—ë—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º.
- Payload —Å–æ–¥–µ—Ä–∂–∏—Ç `metric`, `target_column`, `generations`, `parallel_mode`.
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (–≤–∫–ª—é—á–∞—è `docs/tpot.md`).

---

## üîç –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

| –û–±–ª–∞—Å—Ç—å | –°–æ—Å—Ç–æ—è–Ω–∏–µ | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è |
|--------|-----------|-------------|
|TrainingService|–†—É—á–Ω—ã–µ baseline-–º–æ–¥–µ–ª–∏|–ù–µ—Ç –∞–≤—Ç–æML, –Ω–µ—Ç leaderboard|
|Payload|–í–µ—Ä—Å–∏—è —Ç–æ–ª—å–∫–æ `target_column`, `task`|–ù–µ–ª—å–∑—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –±—é–¥–∂–µ—Ç—ã/–º–µ—Ç—Ä–∏–∫–∏|
|–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞|Backend —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–Ω–æ–ø—Ä–æ—Ü–µ—Å—Å–Ω–æ|–ù–µ—Ç Dask scheduler/workers –ø—Ä–æ—Ü–µ—Å—Å–æ–≤|
|–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è|–ï—Å—Ç—å auto-sklearn guide|–ù—É–∂–Ω–æ –ø–µ—Ä–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ TPOT|

---

## üèóÔ∏è –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FastAPI Backend                                            ‚îÇ
‚îÇ  ‚îú‚îÄ TrainingService                                        ‚îÇ
‚îÇ  ‚îÇ   ‚îú‚îÄ TPOTTrainer (TPOTClassifier/TPOTRegressor)          ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ     ‚îú‚îÄ SearchSpace (ConfigSpace/GraphSearchPipeline)‚îÇ
‚îÇ  ‚îÇ   ‚îÇ     ‚îú‚îÄ Dask Client -> TPOTEstimator                 ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ     ‚îú‚îÄ Serialization (leaderboard, pipeline, metrics)‚îÇ
‚îÇ  ‚îÇ   ‚îî‚îÄ Fallback Trainer (legacy pipeline)                 ‚îÇ
‚îÇ  ‚îî‚îÄ Monitoring & Logging                                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ                    ‚îÇ              ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇLocal n_jobs         ‚îÇ ‚îÇDask Scheduler/     ‚îÇ ‚îÇMinIO / FS Storage‚îÇ
‚îÇ(TPOT_PARALLEL_MODE=local)‚îÇ‚îÇWorkers (--scheduler-file)‚îÇ‚îÇmodel.joblib + leaderboard‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

- `TPOTTrainer` —Å—Ç—Ä–æ–∏—Ç `ConfigSpace`-–±–∞–∑–æ–≤—ã–µ search spaces, –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `TPOT__CONFIG_DICT` –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å —É–∑–ª—ã (EstimatorNode, ChoicePipeline, GraphSearchPipeline).
- –°–æ—Ö—Ä–∞–Ω—è–µ–º `model.joblib`, `leaderboard.json`, `tp_pareto_front.json`, `evaluation_summary`.
- Backend –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Dask client –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –µ–≥–æ –≤ `TPOTEstimator`, –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `n_jobs` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞.

---

## üõ£Ô∏è –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### Phase 0 ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (3-4 –¥–Ω—è)
1. Dockerfile: `build-essential`, `graphviz`, `swig`, `cmake`, `libopenblas-dev`, `libomp-dev`.
2. Python deps:
   - `tpot>=0.12`, `ConfigSpace>=0.6`, `dask[distributed]`, `joblib>=1.3`, `scikit-learn>=1.5`, `numpy`, `pandas`.
   - `uv pip compile`, –æ–±–Ω–æ–≤–∏—Ç—å `requirements.txt`, `uv.lock`.
3. CI: –∫–µ—à –∫–æ–ª–µ—Å, —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã.
4. Feature flags: `ENABLE_AUTOML`, `ENABLE_AUTOML_FALLBACK`, `TPOT_PARALLEL_MODE`, `TPOT__CONFIG_DICT`.

### Phase 1 ‚Äî –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (1 –Ω–µ–¥–µ–ª—è)
1. –°–æ–∑–¥–∞—Ç—å `service/services/automl/` —Å `search_space`, `tpot_trainer`, `serialization`.
2. `TPOTTrainer.train()`:
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `target_column`, `feat_type`, `CustomConfigSpace`.
   - `generations`, `population_size`, `time_left`, `per_run_limit`, `dask_client`.
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `leaderboard_topk`, `evaluated_individuals`, `Pareto_Front`.
3. `TrainingService`: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è `TPOTTrainer`, fallback, –º–µ—Ç—Ä–∏–∫–∏ `tp_generations`, `leaderboard_topk`, `parallel_mode`.
4. `settings.py`, `container.py`: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ env vars, `TPOT__CONFIG_DICT` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `"linear"` –∏–ª–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ TPOT API ‚Äî `tpot.config.get_search_space('regressors')`).

### Phase 2 ‚Äî –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (4-5 –¥–Ω–µ–π)
1. `docker-compose`: `tpot-scheduler`, `tpot-worker` (volume —Å `/var/run/tpot`).
2. CLI-—Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∑–∞–ø—É—Å–∫–æ–≤ `scheduler` –∏ `worker`.
3. Backend –æ–∂–∏–¥–∞–µ—Ç `scheduler.json`, —Å–æ–∑–¥–∞–µ—Ç `Client` –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç `dask_client` –≤ `TPOTEstimator`.
4. Healthchecks –∏ auto-restart workers.

### Phase 3 ‚Äî –¢–µ—Å—Ç—ã –∏ rollout (1 –Ω–µ–¥–µ–ª—è)
1. Unit: —Ç–µ—Å—Ç—ã –¥–ª—è search spaces, trainer, serialization.
2. Integration: `pytest` —Å `time_left=30`, `parallel_mode=local`.
3. Smoke: Jobs —Å —Ä–∞–∑–Ω—ã–º–∏ dataset, –ø—Ä–æ–≤–µ—Ä–∫–∞ `leaderboard`.
4. Performance: 3 dataset (–º–∞–ª—ã–π/—Å—Ä–µ–¥–Ω–∏–π/—à—É–º–Ω—ã–π).
5. Canary: –≤–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è 10% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ `tpot_parallel_fallbacks_total`.

---

## ‚öôÔ∏è –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Ä–µ–∂–∏–º—ã

### Local multi-core
- `TPOT_PARALLEL_MODE=local`, `TPOT__N_JOBS=min(cpu_count-1, 8)`.
- `TPOTEstimator(n_jobs=config.n_jobs, memory_limit=config.memory_limit, generations=config.generations, population_size=config.population_size)`.
- `if __name__ == "__main__"` guard –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.

### Distributed (Dask)
1. Scheduler:
   ```bash
   dask-scheduler --scheduler-file /var/run/tpot/scheduler.json --idle-timeout 300
   ```
2. Worker:
   ```bash
   DASK_DISTRIBUTED__WORKER__DAEMON=False \
   dask-worker --nthreads 1 --memory-limit 0 --scheduler-file /var/run/tpot/scheduler.json
   ```
3. Backend:
   ```python
   client = Client(scheduler_file=config.scheduler_file)
   tpot = TPOTEstimator(dask_client=client)
   ```
4. Watchdog: –µ—Å–ª–∏ `Client` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ª–æ–≥–∏—Ä—É–µ–º `tpot_parallel_fallbacks_total` –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ `n_jobs=1`.

---

## üßÆ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|------------|--------------|
|`TPOT__GENERATIONS`|env/payload|–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫–æ–ª–µ–Ω–∏–π|40|
|`TPOT__POPULATION_SIZE`|env/payload|–†–∞–∑–º–µ—Ä –ø–æ–ø—É–ª—è—Ü–∏–∏|64|
|`TPOT__TIME_LEFT`|env/payload|–ë—é–¥–∂–µ—Ç –ø–æ–∏—Å–∫–∞ (—Å–µ–∫)|600|
|`TPOT__PER_RUN_LIMIT`|env/payload|–í—Ä–µ–º—è –Ω–∞ –º–æ–¥–µ–ª—å|60|
|`TPOT__METRIC`|payload|–ú–µ—Ç—Ä–∏–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏|`accuracy`/`r2`|
|`TPOT__CV_FOLDS`|env|CV folds|5|
|`TPOT__CONFIG_DICT`|env|Search space dict/ConfigSpace|
|`TPOT_PARALLEL_MODE`|env|`local` / `distributed` / `off`|local|
|`TPOT__N_JOBS`|env|–ß–∏—Å–ª–æ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤|`cpu_count-1`|
|`TPOT__MEMORY_LIMIT_MB`|env|–õ–∏–º–∏—Ç –ø–∞–º—è—Ç–∏ –Ω–∞ worker|3072|
# TPOT Integration Plan ‚Äî Training Jobs Upgrade

–°—Ç–∞—Ç—É—Å: üü° –ü–ª–∞–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —á–µ—Ä–Ω–æ–≤–∏–∫–µ ‚Äî —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ (—Å–º. —Ä–∞–∑–¥–µ–ª ¬´–í–Ω–µ—Å—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è¬ª).

–í —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ —Å–æ–±—Ä–∞–Ω –ø–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ TPOT –≤ TrainingService, —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏. –î–æ–∫—É–º–µ–Ω—Ç –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, DevOps –∏ Data Science.

## –ö—Ä–∞—Ç–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- –û–±–∑–æ—Ä –∏ —Ü–µ–ª–∏
- –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —Ç–æ, —á—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Ä–µ–∂–∏–º—ã (local / distributed)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å –∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã
- –†–∏—Å–∫–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –ß–µ–∫–ª–∏—Å—Ç —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã)

## –í–Ω–µ—Å—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ)

- –í `backend/service/services/automl/tpot_trainer.py`:
  - TPOT —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞–µ—Ç —è–≤–Ω—ã–π Dask `Client` (–ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç `client`) ‚Äî TPOT –Ω–µ —Å–æ–∑–¥–∞—ë—Ç LocalCluster –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞.
  - –î–æ–±–∞–≤–ª–µ–Ω ¬´shim¬ª (_ClusterLike) –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω—ã—Ö Client'–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç `client.cluster`, —á—Ç–æ–±—ã –ø—Ä–æ–π—Ç–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ TPOT.
  - Best-effort –ª–æ–≥–∏–∫–∞ –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –≤–æ—Ä–∫–µ—Ä—ã (`client.upload_file`) –∏ –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ –Ω–∞–ª–∏—á–∏—è `pkg_resources` –Ω–∞ –≤–æ—Ä–∫–µ—Ä–∞—Ö.
  - –§–æ–ª–ª–±–µ–∫–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è scorer'–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `sklearn.metrics.get_scorer` —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞–º–∏).
  - –°–Ω–∏–º–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞/–≤–æ—Ä–∫–µ—Ä–æ–≤ –∏ background poller –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (—Ñ–∞–π–ª—ã –ª–æ–≥–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ /tmp –∏ –Ω–∞ —Ö–æ—Å—Ç–µ –≤ `tmp_tpot/`).

- –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞:
  - `backend/Dockerfile.tpot` –æ–±–Ω–æ–≤–ª—ë–Ω: –≤ –æ–±—Ä–∞–∑ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ `setuptools` (—á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å `pkg_resources` –≤ worker'–∞—Ö –∏ –∏–∑–±–µ–∂–∞—Ç—å ModuleNotFoundError).

- –¢–µ—Å—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã:
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω—ã–µ smoke-—É—Ç–∏–ª–∏—Ç—ã –≤ `backend/tools/` (–ª–æ–∫–∞–ª—å–Ω–∞—è –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏).
  - –í `backend/tests/` –¥–æ–±–∞–≤–ª–µ–Ω CI-–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Ç–µ—Å—Ç `test_tpot_smoke_local.py` (–±—ã—Å—Ç—Ä—ã–π –Ω–µ–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø—Ä–æ–≥–æ–Ω).

## –ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ

- –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å Dask `Client` –≤ TPOT ‚Äî –Ω–∞–¥—ë–∂–Ω–µ–µ, —á–µ–º –ø–æ–∑–≤–æ–ª—è—Ç—å TPOT —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–π LocalCluster. –≠—Ç–æ –¥–∞—ë—Ç –Ω–∞–º –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º –∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏.
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ –æ–±—Ä–∞–∑ `setuptools` ‚Äî –ø—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã "No module named 'pkg_resources'" –≤ worker'–∞—Ö.
- –í—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `client.upload_file()` –∫–∞–∫ fallback –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ –ø—Ä–æ–µ–∫—Ç–Ω–æ–≥–æ –∫–æ–¥–∞ –Ω–∞ –≤–æ—Ä–∫–µ—Ä—ã; —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–µ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ ‚Äî –≤–∫–ª—é—á–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ –æ–±—Ä–∞–∑ –≤–æ—Ä–∫–µ—Ä–∞ (COPY), —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ä–µ–¥—É, –∏–¥–µ–Ω—Ç–∏—á–Ω—É—é –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É –∏ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º.

## –ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É smoke –∏ –æ—Ç–ª–∞–¥–∫–∏ (—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É)

1. –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ TPOT (–µ—Å–ª–∏ –≤—ã –º–µ–Ω—è–ª–∏ Dockerfile):
   - docker compose -f docker-compose.tpot.yml build --parallel
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å scheduler –∏ worker'—ã (compose):
   - docker compose -f docker-compose.tpot.yml up -d
3. –í –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `TPOT_DASK_ADDRESS` —É–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å scheduler'–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä `tcp://mlservice-dask-scheduler-1:8786`, –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é —É—Ç–∏–ª–∏—Ç—É `backend/tools/tpot_trainer_smoke_distributed_minimal.py`.
4. –õ–æ–≥–∏ –∏ —Å–Ω–∏–º–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `tmp_tpot/` –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–Ω–∞ —Ö–æ—Å—Ç–µ).

## –ö–ª—é—á–µ–≤—ã–µ —Ä–∏—Å–∫–∏ / –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- –ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏–π –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ worker'–∞–º–∏ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á (Dask). –†–µ—à–µ–Ω–∏–µ: –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–∞—Ä–∏—Ç–µ—Ç –ø–∞–∫–µ—Ç–æ–≤ –∏ PYTHONPATH (–ª—É—á—à–µ ‚Äî —Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ –≤–æ—Ä–∫–µ—Ä–∞ —Å –ø—Ä–æ–µ–∫—Ç–æ–º).
- –í —Ä–∞–Ω–Ω–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã worker'—ã —Å –∞–Ω–æ–º–∞–ª—å–Ω–æ –º–∞–ª–µ–Ω—å–∫–∏–º `memory_limit` (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1 KiB), —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ —Ä–µ—Å—Ç–∞—Ä—Ç–∞–º –∏ –æ—à–∏–±–∫–∞–º TPOT. –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —Ä–∞–Ω–Ω–∏–π —Ñ–µ–π–ª —Å –ø–æ–Ω—è—Ç–Ω–æ–π –æ—à–∏–±–∫–æ–π, –Ω–æ –ª—É—á—à–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –æ–±—Ä–∞–∑–∞/compose.

## –ö–æ—Ä–æ—Ç–∫–∏–π —á–µ–∫–ª–∏—Å—Ç —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã)

1. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ: –æ–±—Ä–∞–∑ –≤–æ—Ä–∫–µ—Ä–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç–Ω—ã–π –∫–æ–¥ (COPY) + setuptools. (–í–∞—Ä–∏–∞–Ω—Ç: –ø—Ä–∏–Ω—è—Ç—å runtime upload_file –∫–∞–∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.)
2. –î–æ–±–∞–≤–∏—Ç—å –±—ã—Å—Ç—Ä—ã–π CI-—Ä—É—Ç–∏–Ω: –∑–∞–ø—É—Å–∫ `backend/tests/test_tpot_smoke_local.py` –≤ PR (fast job).
3. –î–æ–±–∞–≤–∏—Ç—å gated/manual workflow –¥–ª—è heavy distributed smoke (workflow_dispatch) —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ —Å–±–æ—Ä–∫–µ –æ–±—Ä–∞–∑–æ–≤ –∏ –ø–æ–¥–Ω—è—Ç–∏—é compose –Ω–∞ runner —Å Docker.
4. –£–ª—É—á—à–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: –¥–æ–±–∞–≤–∏—Ç—å alert –Ω–∞ –ø–æ–¥—Ä—è–¥ > 3 –æ—à–∏–±–æ–∫ TPOT –∏ –∞–ª–µ—Ä—Ç –Ω–∞ —á–∞—Å—Ç—ã–µ nanny restarts —É worker'–æ–≤.
5. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `search_space` –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—è (legacy config_dict ‚Üí search space) –∏ –ø–æ–∫—Ä—ã—Ç—å edge-cases.

---

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ, —è –º–æ–≥—É –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —á–µ—Ä–Ω–æ–≤—ã–µ –ø–∞—Ç—á–∏/PR-–æ–ø–∏—Å–∞–Ω–∏–µ –∏ —Å–Ω–∏–ø–ø–µ—Ç—ã –∫–æ–º–∞–Ω–¥ –¥–ª—è DevOps (—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞), –Ω–æ –ø–æ –≤–∞—à–µ–π –ø—Ä–æ—Å—å–±–µ –Ω–µ –±—É–¥—É –∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∞–º–∞ ‚Äî –æ—Å—Ç–∞–≤–ª—é –≥–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –≤ —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏.
